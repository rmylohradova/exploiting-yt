import psycopg2
from dotenv import load_dotenv
import os


load_dotenv()
yt_key = os.environ['YOUTUBE_API_KEY']
userpass = os.environ['USER']
pg_port = os.environ['port']
db_name = os.environ['db']


def extract_languages():
    """selecting attribute set 'language' from relation top_per_region"""
    try:
        connection = psycopg2.connect(user=userpass,
                                      host="localhost",
                                      port=pg_port,
                                      database=db_name)
        cursor = connection.cursor()
        postgreSQL_select_Query = "select lang from top_per_region"
        cursor.execute(postgreSQL_select_Query)
        langs = cursor.fetchall()
        with open('queries/langs_list.txt', 'w') as write_file:
            for row in langs:
                print(row[0])
                write_file.write(str(row[0]) + "\n")

    except (Exception, psycopg2.Error) as error:
        print("Error while fetching data from PostgreSQL", error)

    finally:
        if connection:
            cursor.close()
            connection.close()
            print("PostgreSQL connection is closed")

if __name__ == '__main__':
    extract_languages()
